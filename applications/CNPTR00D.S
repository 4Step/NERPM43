; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=PUBLIC TRANSPORT PRNFILE="{SCENARIO_DIR}\output\CNPTR00C.PRN" MSG='All walk skim'
FILEI NETI = "{SCENARIO_DIR}\output\PRELOAD_PT.NET"
FILEO ROUTEO[1] = "{SCENARIO_DIR}\output\AllWalk_{alt}{Year}.RTE"
FILEO MATO[1] = "{SCENARIO_DIR}\output\AllWalk_{alt}{Year}.MAT",
 MO=1,DEC=2,NAME=ALLWALK
FILEO REPORTO = "{SCENARIO_DIR}\output\CNPTR00B.RPT"
FILEI FACTORI[1] = "{SCENARIO_DIR}\input\WalkCOMRAIL.FAC"
FILEI FAREI = "{SCENARIO_DIR}\input\TFARES_{year}{alt}.FAR"
FILEI SYSTEMI = "{CATALOG_DIR}\parameters\SYSTEM.PTS"
FILEI LINEI[1] = "{SCENARIO_DIR}\input\TROUTE_{year}{alt}.LIN"

; OVERALL PARAMETERS OF RUN
PARAMETERS USERCLASSES=1,FARE=N, MAPSCALE=5280, HDWAYPERIOD=1,
           NOROUTEERRS=999999, NOROUTEMSGS=999999,
           TRANTIME=LW.TRANTIME,
           TRANTIME[21]=LI.M21TIMEPK,
           TRANTIME[22]=LI.M22TIMEPK,
           TRANTIME[23]=LI.M23TIMEPK,
           TRANTIME[24]=LI.M24TIMEPK

REPORT LINES=T
PROCESS PHASE=LINKREAD
 LW.TRANTIME=LI.M21TIMEPK
 LW.WALKTIME=LI.WALKTIME
 LW.WALKDISTANCE=LI.DISTANCE
 LW.DISTANCE=LI.DISTANCE
ENDPROCESS

PROCESS PHASE=DATAPREP

  ; 4 - ALL-WALKS
  GENERATE, COST=(LW.DISTANCE),EXTRACTCOST=(LW.WALKTIME),MAXCOST=200*7,LIST=N,EXCLUDELINK=(LI.FACILITY_TYPE=10-19,69,70-99),
            NTLEGMODE=4,MAXNTLEGS=200*{MAXWLKACCLNKS},DIRECTION=3,ONEWAY=F,FROMNODE=1-{ZONESI},TONODE=1-{ZONESI}

ENDPROCESS


PROCESS PHASE=SKIMIJ
 IF (TIMEA(0,4) > 0)
  MW[1]=TIMEA(0,4)     ; all walk time
 ELSE
  MW[1]=9999.99
 ENDIF
ENDPROCESS

ENDRUN
