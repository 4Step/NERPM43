; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=PUBLIC TRANSPORT PRNFILE="{CATALOG_DIR}\APPLICATIONS\TPPTR00D.PRN" MSG='Generate OP PNR & KNR Links'
FILEI MATI[1] = "{SCENARIO_DIR}\OUTPUT\FHSKIMTT_PT.{ALT}{Year}"
FILEI FAREI = "C:\NERPM43\applications\Warmstart\TFARES_10A.FAR"
FILEI SYSTEMI = "C:\NERPM43\applications\Warmstart\SYSTEM.PTS"
FILEI FACTORI[1] = "C:\NERPM43\applications\Warmstart\PNRPrj.FAC"
FILEI LINEI[1] = "C:\NERPM43\applications\Warmstart\TROUTE_10A.LIN"
FILEI NETI = "{SCENARIO_DIR}\output\HWYLOAD2_PNR_MD_{Alt}{Year}.NET"

FILEO PRINTO[2] = "{SCENARIO_DIR}\OUTPUT\PT_AUTOCON_OP.OUT"
FILEO PRINTO[1] = "{SCENARIO_DIR}\OUTPUT\NTLEG2OP_{ALT}{Year}.PRN"
FILEO NTLEGO = "{SCENARIO_DIR}\OUTPUT\NTLEG2OP_{ALT}{Year}.NTL"
FILEO NETO = "{SCENARIO_DIR}\OUTPUT\NTLEG2OP_{ALT}{Year}.NET"


; OVERALL PARAMETERS OF RUN
PARAMETERS USERCLASSES=1,FARE=N, MAPSCALE={UNITS}, HDWAYPERIOD=2,
           NOROUTEERRS=999999, NOROUTEMSGS=999999,
           TRANTIME=LW.TRANTIME,
           TRANTIME[21]=LI.M21TIMEOP,
           TRANTIME[22]=LI.M22TIMEOP,
           TRANTIME[23]=LI.M23TIMEOP,
           TRANTIME[27]=LI.M27TIMEOP

REPORT LINES=T
PROCESS PHASE=LINKREAD
   LW.TRANTIME=LI.M21TIMEOP
   LW.WALKTIME=LI.WALKTIME
   LW.WALKDISTANCE=LI.DISTANCE
   LW.DISTANCE=LI.DISTANCE
   LW.ADJDISTANCE=LI.ADJDISTANCE
   LW.CGS_TIME=LI.TIME
ENDPROCESS

PROCESS PHASE=DATAPREP
; GENERATE AUTO CONNECTORS FOR PNR AND KNR
   list='\nGenerate Zone Access/Egress Legs'
   GENERATE, 
     PNR=T,
      KNR=T,
      PERIOD=2,
      PNRMODE=2,
      KNRMODE=3,
      INTERNALZONES=1-{zonesi},
      CBDZONE={CBDZONE},
      ORIGINTERMTIME=2.0,
      DEFDRIVETIME=2.0,
      CHECKRELEVANCE=1,
      CHECKBACKTRACK=1,
      MAXBACKDIST=4.0,
      MAXBACKFACTOR=0.30,
      DISTANCEFACTOR={UNITS},
      PREMIUMMODE=0,1,0,1,1,1,1,
      MODEPRIORITY=7,5,7,2,1,4,3,
      VOT=6,3,
      OVTRATIO=2,2,
      AATRATIO=1.5,1.5,
      AUTOCCPNR={OCCPNRAccess},
      AUTOCCKNR={OCCPNRAccess},
      AOC={hwyopcost},
      INFLTRANSITFARE={InflationFare},
      INFLAOC={InflationAOC},
      INFLPARKINGCOST=1.1976,    ;{InflationParkCost},
      MAXCHECK = 2,
      MAXCONN = 2,
      CONNREPORT=1,
      GENREPORT=2,
      TIMEMAT=MI.1.4,
      DISTMAT=MI.1.2,
      AUTOMATCH=T      ; T=original logic, F=Enhanced logic

ENDPROCESS

ENDRUN
