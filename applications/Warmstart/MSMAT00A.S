; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=MATRIX PRNFILE="C:\NERPM43\APPLICATIONS\WARMSTART\MSMAT00A.PRN"
FILEO PRINTO[2] = "C:\NERPM43\APPLICATIONS\WARMSTART\seedmat2.csv"
FILEI ZDATI[1] = "C:\NERPM43\APPLICATIONS\WARMSTART\Model_TAZ_District_Lookup.prn",
Z=16-20,DIST=12-13
FILEO PRINTO[1] = "C:\NERPM43\APPLICATIONS\WARMSTART\seedmat.csv"
FILEI MATI[1] = "C:\NERPM43\APPLICATIONS\WARMSTART\CALIB98A.MC3"

zonemsg=500

ARRAY M1=37,M2=37,M3=37,M4=37,M5=37,M6=37,M7=37,M8=37,M9=37,M10=37,M11=37,M12=37,DSTR={ZONESA}

FILLMW MW[1]=MI.1.1.T
FILLMW MW[2]=MI.1.2.T
FILLMW MW[3]=MI.1.3.T
FILLMW MW[4]=MI.1.4.T
FILLMW MW[5]=MI.1.5.T
FILLMW MW[6]=MI.1.6.T
FILLMW MW[7]=MI.1.7.T
FILLMW MW[8]=MI.1.8.T
FILLMW MW[9]=MI.1.9.T
FILLMW MW[10]=MI.1.10.T
FILLMW MW[11]=MI.1.11.T
FILLMW MW[12]=MI.1.12.T

rows1=ROWSUM(1)
rows2=ROWSUM(2)
rows3=ROWSUM(3)
rows4=ROWSUM(4)
rows5=ROWSUM(5)
rows6=ROWSUM(6)
rows7=ROWSUM(7)
rows8=ROWSUM(8)
rows9=ROWSUM(9)
rows10=ROWSUM(10)
rows11=ROWSUM(11)
rows12=ROWSUM(12)
DSTR[I]=DIST
DST=INT(DIST)

print csv=t,list=I(5.0),DSTR[I](5.0),rows1(8.0),rows2(8.0),rows3(8.0),rows4(8.0),rows5(8.0),rows6(8.0),rows7(8.0),rows8(8.0),rows9(8.0),rows10(8.0),rows11(8.0),rows12(8.0),printo=1

M1[DST]=M1[DST]+rows1
M2[DST]=M2[DST]+rows2
M3[DST]=M3[DST]+rows3
M4[DST]=M4[DST]+rows4
M5[DST]=M5[DST]+rows5
M6[DST]=M6[DST]+rows6
M7[DST]=M7[DST]+rows7
M8[DST]=M8[DST]+rows8
M9[DST]=M9[DST]+rows9
M10[DST]=M10[DST]+rows10
M11[DST]=M11[DST]+rows11
M12[DST]=M12[DST]+rows12

IF (I={ZONESA})
   LOOP DISTRICT=1,1
   PRINT CSV=T, LIST=DISTRICT(6.0),
                M1[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M2[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M3[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M4[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M5[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M6[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M7[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M8[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M9[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M10[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M11[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M12[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10), PRINTO=2
    ENDLOOP
/*
   LOOP WW=1,{ZONESA}
   DISTRICT=DSTR[WW]
   PRINT CSV=T, LIST=WW(6.0),DISTRICT(3.0),
                M1[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M2[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M3[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M4[DISTRICT]/(M1[DISTRICT]+M2[DISTRICT]+M3[DISTRICT]+M4[DISTRICT])(12.10),
                M5[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M6[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M7[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M8[DISTRICT]/(M5[DISTRICT]+M6[DISTRICT]+M7[DISTRICT]+M8[DISTRICT])(12.10),
                M9[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M10[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M11[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10),
                M12[DISTRICT]/(M9[DISTRICT]+M10[DISTRICT]+M11[DISTRICT]+M12[DISTRICT])(12.10), PRINTO=2
    ENDLOOP
*/

ENDIF


ENDRUN
