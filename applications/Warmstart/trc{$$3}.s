; Script for program DISTRIBUTION in file "C:\NERPM43\APPLICATIONS\WARMSTART\PADST00C.S"
; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=DISTRIBUTION PRNFILE="{SCENARIO_DIR}\output\PREDISTRIB.PRN" MSG='pre-distribution'

FILEO MATO[5] = "{SCENARIO_DIR}\output\TripsRuralCounties.MAT",
MO=71-82,NAME=HBW_Rural,HBSH_Rural,HBSR_Rural,HBO_Rural,NHB_Rural,
               LTRK_Rural,MTRK_Rural,HTRK_Rural,SOIE_Rural,HOIE_Rural,LDIE_Rural,HDIE_Rural dec=12*s

FILEO MATO[4] = "{SCENARIO_DIR}\output\VehHoursRuralCounties.MAT",
 MO=51-62,NAME=HBW_Rural,HBSH_Rural,HBSR_Rural,HBO_Rural,NHB_Rural,
               LTRK_Rural,MTRK_Rural,HTRK_Rural,SOIE_Rural,HOIE_Rural,LDIE_Rural,HDIE_Rural dec=12*s

FILEO MATO[3] = "{SCENARIO_DIR}\output\VehHoursAllCounties.MAT",
 MO=31-42,NAME=HBW_All,HBSH_All,HBSR_All,HBO_All,NHB_All,
          LTRK_All,MTRK_All,HTRK_All,SOIE_All,HOIE_All,LDIE_All,HDIE_All dec=12*s

FILEI LOOKUPI[3] = "{CATALOG_DIR}\parameters\\FF_Rural.CSV"
FILEI MATI[1] = "{SCENARIO_DIR}\output\FHSKIMS.MAT"
FILEI LOOKUPI[2] = "{CATALOG_DIR}\parameters\SUBAREABAL.CSV"
FILEI ZDATI[1] = "{SCENARIO_DIR}\output\PANDA.DBF"

FILEO MATO[2] = "{SCENARIO_DIR}\output\VTRIP1.MAT",
 mo=6-12, name=LTRK,MTRK,HTRK,SOIE,HOIE,LDIE,HDIE, dec=7*s
FILEI LOOKUPI[1] = "{CATALOG_DIR}\parameters\FF.CSV"

FILEO MATO[1] = "{SCENARIO_DIR}\output\PTRIP1.MAT",
 MO=1-5,20,NAME=HBW,HBSH,HBSR,HBO,NHB,GMTIME dec=5*s

PAR MAXITERS={ATITER},MAXRMSE=2, ZONEMSG=100

    LOOKUP, LOOKUPI=1,
        INTERPOLATE=Y, NAME=FF,
        LOOKUP[1]=1,RESULT=2,
        LOOKUP[2]=1,RESULT=3,
        LOOKUP[3]=1,RESULT=4,
        LOOKUP[4]=1,RESULT=5,
        LOOKUP[5]=1,RESULT=6,
        LOOKUP[6]=1,RESULT=7,
        LOOKUP[7]=1,RESULT=8,
        LOOKUP[8]=1,RESULT=9,
        LOOKUP[9]=1,RESULT=10,
        LOOKUP[10]=1,RESULT=11,
        LOOKUP[11]=1,RESULT=12,
        LOOKUP[12]=1,RESULT=13

    LOOKUP, LOOKUPI=2,
        INTERPOLATE=N, NAME=ATRFAC,
        LOOKUP[1]=1,RESULT=3,
        LOOKUP[2]=1,RESULT=4,
        LOOKUP[3]=1,RESULT=5,
        LOOKUP[4]=1,RESULT=6,
        LOOKUP[5]=1,RESULT=7,
        LOOKUP[6]=1,RESULT=8,
        LOOKUP[7]=1,RESULT=9,
        LOOKUP[8]=1,RESULT=10,
        LOOKUP[9]=1,RESULT=11,
        LOOKUP[10]=1,RESULT=12,
        LOOKUP[11]=1,RESULT=13,
        LOOKUP[12]=1,RESULT=14

    LOOKUP, LOOKUPI=3,
        INTERPOLATE=Y, NAME=FFRural,
        LOOKUP[1]=1,RESULT=2,
        LOOKUP[2]=1,RESULT=3,
        LOOKUP[3]=1,RESULT=4,
        LOOKUP[4]=1,RESULT=5,
        LOOKUP[5]=1,RESULT=6,
        LOOKUP[6]=1,RESULT=7,
        LOOKUP[7]=1,RESULT=8,
        LOOKUP[8]=1,RESULT=9,
        LOOKUP[9]=1,RESULT=10,
        LOOKUP[10]=1,RESULT=11,
        LOOKUP[11]=1,RESULT=12,
        LOOKUP[12]=1,RESULT=13

;   ----- SETUP THE WORKING P'S AND A'S
;HBWKP,HBWKA,HBSHP,HBSHA,HBSRP,HBSRA,HBOTP,HBOTA,NHBSP,NHBSA,LTRKP,LTRKA,
;MTRKP,MTRKA,HTRKP,HTRKA,SOIEP,SOIEA,HOIEP,HOIEA,LDIEP,LDIEA,HDIEP,HDIEA

    SETPA P[1]=HBWKP  A[1]=HBWKA  *ATRFAC(1,I)  ;These factors are used for subarea balancing
    SETPA P[2]=HBSHP  A[2]=HBSHA  *ATRFAC(2,I)  ;and have been temporarily removed for
    SETPA P[3]=HBSRP  A[3]=HBSRA  *ATRFAC(3,I)  ;testing purposes.  Reintroduce these factors
    SETPA P[4]=HBOTP  A[4]=HBOTA  *ATRFAC(4,I)  ;if subarea balancing is still needed after
    SETPA P[5]=NHBSP  A[5]=NHBSA  *ATRFAC(5,I)  ;testing.
    SETPA P[6]=LTRKP  A[6]=LTRKA  *ATRFAC(6,I)
    SETPA P[7]=MTRKP  A[7]=MTRKA  *ATRFAC(7,I)
    SETPA P[8]=HTRKP  A[8]=HTRKA  *ATRFAC(8,I)
    SETPA P[9]=SOIEP  A[9]=SOIEA  *ATRFAC(9,I)
    SETPA P[10]=HOIEP A[10]=HOIEA *ATRFAC(10,I)
    SETPA P[11]=LDIEP A[11]=LDIEA *ATRFAC(11,I)
    SETPA P[12]=HDIEP A[12]=HDIEA *ATRFAC(12,I)

;   ----- DO 12 GRAVITY MODELS
;sks:    MW[20]=MI.1.TIME+MI.1.TERMINALTIME  
    MW[20]=MI.1.WtdTime+MI.1.TERMINALTIME      ; Include WtdTime in distribution, WtdTime includes toll time and cost


   MW[90]=MI.1.Distance ; Include also intrazonal distance to report trip length in miles


if (i=2401-2450 | i=2451-2549 | i=2554-2563 | i=2569-2575)             ;Baker & Putnam (Rural Co) Zones

    GRAVITY PURPOSE=1, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=2, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=3, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=4, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=5, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=6, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=7, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=8, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=9, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=10, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=11, LOS=MW[20], FFACTORS=FFRural
    GRAVITY PURPOSE=12, LOS=MW[20], FFACTORS=FFRural
else
    GRAVITY PURPOSE=1, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=2, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=3, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=4, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=5, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=6, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=7, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=8, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=9, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=10, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=11, LOS=MW[20], FFACTORS=FF
    GRAVITY PURPOSE=12, LOS=MW[20], FFACTORS=FF
endif

;All Counties (including Rural -Baker+Putnam- Counties) ...
;   ----- GENERATE FREQUENCY DISTRIBUTION REPORTS (Time in minutes)
FREQUENCY VALUEMW=1  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HBW TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=2  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HBSH TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=3  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HBSR TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=4  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HBO TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=5  BASEMW=20,  RANGE=1-100, TITLE='All Counties-NHB TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=6  BASEMW=20,  RANGE=1-100, TITLE='All Counties-LTRK TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=7  BASEMW=20,  RANGE=1-100, TITLE='All Counties-MTRK TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=8  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HTRK TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=9  BASEMW=20,  RANGE=1-100, TITLE='All Counties-SOV IE TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=10  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HOV IE TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=11  BASEMW=20,  RANGE=1-100, TITLE='All Counties-LD IE TRIP LENGTH FREQUENCY {descr}'
FREQUENCY VALUEMW=12  BASEMW=20,  RANGE=1-100, TITLE='All Counties-HD IE TRIP LENGTH FREQUENCY {descr}'
;added by SKS (10-30-2008)
;TLFD wrt DISTANCE (DOES NOT include Terminal and toll equivalency DISTANCE, BUT INCLUDES intrazonal distance)
FREQUENCY VALUEMW=1  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HBW TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=2  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HBSH TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=3  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HBSR TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=4  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HBO TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=5  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-NHB TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=6  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-LTRK TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=7  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-MTRK TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=8  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HTRK TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=9  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-SOV IE TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=10  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HOV IE TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=11  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-LD IE TRAVEL DISTANCE FREQUENCY {descr}'
FREQUENCY VALUEMW=12  BASEMW=90,  RANGE=0-100-2, TITLE='All Counties-HD IE TRAVEL DISTANCE FREQUENCY {descr}'


if (i=2401-2450 | i=2451-2549 | i=2554-2563 | i=2569-2575)             ;Baker & Putnam (Rural Co) Zones

   ;Rural (Baker & Putnam) Counties) ...
   ;   ----- GENERATE FREQUENCY DISTRIBUTION REPORTS (Time in minutes)
   FREQUENCY VALUEMW=1  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HBW TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=2  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HBSH TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=3  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HBSR TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=4  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HBO TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=5  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-NHB TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=6  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-LTRK TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=7  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-MTRK TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=8  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HTRK TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=9  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-SOV IE TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=10  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HOV IE TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=11  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-LD IE TRIP LENGTH FREQUENCY {descr}'
   FREQUENCY VALUEMW=12  BASEMW=20,  RANGE=1-100, TITLE='Rural Counties-HD IE TRIP LENGTH FREQUENCY {descr}'
   ;TLFD wrt DISTANCE (DOES NOT include Terminal and toll equivalency DISTANCE, BUT INCLUDES intrazonal distance)
   FREQUENCY VALUEMW=1  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HBW TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=2  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HBSH TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=3  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HBSR TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=4  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HBO TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=5  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-NHB TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=6  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-LTRK TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=7  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-MTRK TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=8  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HTRK TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=9  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-SOV IE TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=10  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HOV IE TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=11  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-LD IE TRAVEL DISTANCE FREQUENCY {descr}'
   FREQUENCY VALUEMW=12  BASEMW=90,  RANGE=0-100-2, TITLE='Rural Counties-HD IE TRAVEL DISTANCE FREQUENCY {descr}'

endif



;IF (ITERATION=1)
;  PRINT FORM=9.0, LIST=I,ZI.1.HBWKP[I],
;        FILE = "C:\FSUTMS\DISTRICT2\NERPM\CUBE\IPFME.ROW"
;  PRINT FORM=9.0, LIST=I,ZI.1.HBWKA[I],
;        FILE = "C:\FSUTMS\DISTRICT2\NERPM\CUBE\IPFME.COL"
;  JLOOP
;      PRINT FORM=9.0, LIST=I,J,MW[2],
;        FILE = "C:\FSUTMS\DISTRICT2\NERPM\CUBE\IPFME.SED"
;  ENDJLOOP
;ENDIF

;Person/Vehicle Hours - All Counties
mw[31]=mw[1]*mw[20]/60
mw[32]=mw[2]*mw[20]/60
mw[33]=mw[3]*mw[20]/60
mw[34]=mw[4]*mw[20]/60
mw[35]=mw[5]*mw[20]/60
mw[36]=mw[6]*mw[20]/60
mw[37]=mw[7]*mw[20]/60
mw[38]=mw[8]*mw[20]/60
mw[39]=mw[9]*mw[20]/60
mw[40]=mw[10]*mw[20]/60
mw[41]=mw[11]*mw[20]/60
mw[42]=mw[12]*mw[20]/60

;Person/Vehicle Hours & Trips - Rural Counties
if (i=2401-2450 | i=2451-2549 | i=2554-2563 | i=2569-2575)             ;Baker & Putnam (Rural Co) Zones
   mw[51]=mw[1]*mw[20]/60
   mw[52]=mw[2]*mw[20]/60
   mw[53]=mw[3]*mw[20]/60
   mw[54]=mw[4]*mw[20]/60
   mw[55]=mw[5]*mw[20]/60
   mw[56]=mw[6]*mw[20]/60
   mw[57]=mw[7]*mw[20]/60
   mw[58]=mw[8]*mw[20]/60
   mw[59]=mw[9]*mw[20]/60
   mw[60]=mw[10]*mw[20]/60
   mw[61]=mw[11]*mw[20]/60
   mw[62]=mw[12]*mw[20]/60

  MW[71]=MW[1]
  MW[72]=MW[2]
  MW[73]=MW[3]
  MW[74]=MW[4]
  MW[75]=MW[5]
  MW[76]=MW[6]
  MW[77]=MW[7]
  MW[78]=MW[8]
  MW[79]=MW[9]
  MW[80]=MW[10]
  MW[81]=MW[11]
  MW[82]=MW[12]

endif

;   ----- GET A COMPARISON REPORT ON LAST ITERATION
;REPORT ACOMP=1-12 ITERATIONS=99
ENDRUN


