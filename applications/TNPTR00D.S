; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=PUBLIC TRANSPORT PRNFILE="C:\KumarA\NERPM\CUBE\TNPTR00G.PRN" MSG='MD Auto Access Network'
FILEI TURNPENI = "{MASTERTCARDS}"
FILEI NETI = "{OUTDIR}\UNLOADED.NET"
FILEI LINEI[1] = "{INDIR}\TROUTE.LIN"
FILEI FACTORI[3] = "{indir}\TNETMD6.FAC"
FILEI FACTORI[2] = "{indir}\TNETMD5.FAC"
FILEI FACTORI[1] = "{indir}\TNETMD4.FAC"
FILEI FAREI = "{INDIR}\BASEFARES.FAR"
FILEO MATO[3] = "C:\KumarA\NERPM\CUBE\TSKIMMD6.MAT",
 MO=1-9, NAME=WALKTIME,AUTOTIME,IWAIT,LBTIME,EBTIME,RLTIME,XWAIT,XFERS,FARE
FILEO MATO[2] = "C:\KumarA\NERPM\CUBE\TSKIMMD5.MAT",
 MO=1-9, NAME=WALKTIME,AUTOTIME,IWAIT,LBTIME,EBTIME,RLTIME,XWAIT,XFERS,FARE
FILEO MATO[1] = "C:\KumarA\NERPM\CUBE\TSKIMMD4.MAT",
 MO=1-9, NAME=WALKTIME,AUTOTIME,IWAIT,LBTIME,EBTIME,RLTIME,XWAIT,XFERS,FARE
FILEO ROUTEO[3] = "C:\KumarA\NERPM\CUBE\TROUTEMD6.RTE",
  REPORTI=1-{ZONESA}, REPORTJ={CBDZONE}
FILEO ROUTEO[2] = "C:\KumarA\NERPM\CUBE\TROUTEMD5.RTE",
  REPORTI=1-{ZONESA}, REPORTJ={CBDZONE}
FILEO ROUTEO[1] = "C:\KumarA\NERPM\CUBE\TROUTEMD4.RTE",
  REPORTI=1-{ZONESA}, REPORTJ={CBDZONE}
FILEO NETO = "C:\KumarA\NERPM\CUBE\TRNAUTOMD.NET"
FILEI SYSTEMI = "{INDIR}\SYSTEM.PTS"
FILEO REPORTO = "C:\KumarA\NERPM\CUBE\TNPTR00H.PRN"

; OVERALL PARAMETERS OF RUN
PARAMETERS USERCLASSES=1-3,FARE=N, MAPSCALE=5280,  HDWAYPERIOD=2,
           NOROUTEERRS=999999, NOROUTEMSGS=999999, 
           TRANTIME=LW.TRANTIME,
           TRANTIME[4]=LI.LB4TIME,
           TRANTIME[5]=LI.LB5TIME,
           TRANTIME[6]=LI.EB6TIME,
           TRANTIME[7]=LI.RL7TIME,
           TRANTIME[8]=LI.RL8TIME
REPORT LINES=T
PROCESS PHASE=LINKREAD
 LW.TRANTIME=LI.LB4TIME
 LW.WALKTIME=LI.WALKTIME
 LW.WALKDISTANCE=LI.WALKDISTANCE
 LW.DISTANCE=LI.DISTANCE
ENDPROCESS

PROCESS PHASE=DATAPREP
; WALK EGRESS
  GENERATE, COST=(LW.WALKTIME),DIRECTLINK=125,MAXCOST=4*24,LIST=T,NTLEGMODE = 101,MAXNTLEGS=4,
            DIRECTION=2,  FROMNODE=1-{zonesa}, TONODE=1650-99999
; SIDEWALKS
READ,
 FILE = "C:\KUMARA\NERPM\CUBE\SIDEWALKSMD.TXT"
; AUTO CONNECTORS
READ,
 FILE = "C:\KUMARA\NERPM\CUBE\STATIONMD.TXT"
ENDPROCESS

PROCESS PHASE=SKIMIJ
  MW[1]=TIMEA(0,101)+TIMEA(0,1)+TIMEA(0,3)
  MW[2]=TIMEA(0,2)
  MW[3]=IWAITA(0)
  MW[4]=TIMEA(0,4)+TIMEA(0,5)
  MW[5]=TIMEA(0,6)
  MW[6]=TIMEA(0,7)+TIMEA(0,8)
  MW[7]=XWAITA(0)
  MW[8]=BRDINGS(0,TMODES)-1
  MW[9]=FAREA(0)
ENDPROCESS
PROCESS PHASE=MATO
   JLOOP
     IF (MW[8]<0) MW[8]=0
   ENDJLOOP
ENDPROCESS



ENDRUN
