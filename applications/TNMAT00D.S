; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=MATRIX PRNFILE="C:\KumarA\NERPM\CUBE\TNMAT00E.PRN" MSG='Generate CODWMD.{ALT}{YEAR}'
FILEO PRINTO[1] = "C:\KumarA\NERPM\CUBE\CODWMD.{ALT}{YEAR}"

ARRAY COST={ZONESA}, MINCOST={ZONESA},MAXCOST={ZONESA}, CONNECTORCNT={ZONESA}

; CULL OUT THE ACCESS LINKS
ANODE=RI.A
IF (ANODE=1-{ZONESA}&RI.MODE=1) 
  CST=RI.TIME
  CONNECTORCNT[ANODE]=CONNECTORCNT[ANODE]+1
  IF (CST>MAXCOST[ANODE]) MAXCOST[ANODE]=CST
  IF (CONNECTORCNT[ANODE]=1) MINCOST[ANODE]=CST
  IF (CST<MINCOST[ANODE]) MINCOST[ANODE]=CST
ENDIF

; GENERATE CODWAM FILE
  IF (I=0) 
       LOOP WW=1,{ZONESA}
         IF (MINCOST[WW]=0) MINCOST[WW]=999.9
         MINCOST[WW]=MINCOST[WW]*10
         PRINT LIST=WW(5.0),MINCOST[WW](5.0),CONNECTORCNT[WW](5.0), PRINTO=1
       ENDLOOP  
  ENDIF


ENDRUN
