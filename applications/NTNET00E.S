; Do not change filenames or add or remove FILEI/FILEO statements using an editor. Use Cube/Application Manager.
RUN PGM=NETWORK PRNFILE="C:\NERPM43\APPLICATIONS\NTNET00C.PRN" MSG='Add Directional code to a working net for Baker & Putnam & Update Misc attributes'
FILEI LINKI[1] = "C:\NERPM43\parameters\MicroCodedHnet2m.net"
FILEO NETO = "C:\NERPM43\PARAMETERS\MICROCODEDHNET3.NET"


PHASE=NODEMERGE

;Clear out and fill slected node attributes of Baker and Putnam
IF(COUNTY=5-6)
   TSNAME=''

   TSSTATION_00A=0
   STATZONE=0
   TSRANGE_00A=0
   TSPARKSPACE_00A=0
   TSCOSTAM_00A=0
   TSCOSTMD_00A=0
   TSTYPE_00A=0
   FAREZONE_00A=0
   TSSTATION_05A=0
   TSRANGE_05A=0
   TSPARKSPACE_05A=0
   TSCOSTAM_05A=0
   TSCOSTMD_05A=0
   TSTYPE_05A=0
   FAREZONE_05A=0
   TSSTATION_30A=0
   TSRANGE_30A=0
   TSPARKSPACE_30A=0
   TSCOSTAM_30A=0
   TSCOSTMD_30A=0
   TSTYPE_30A=0
   FAREZONE_30A=0
   TAZNEW=0
    
     IF (N=2401-2429,2451-2494)
       TAZNEW=1
     ENDIF
ENDIF




ENDPHASE

PHASE=LINKMERGE
; Calculate ROADDIR for non-centroid links of Baker & Putnam
  IF((COUNTY=5-6)& (!(FTYPE_05A=50)))

     IF (ABS(A.X-B.X)>ABS(A.Y-B.Y)&A.X<B.X) ROADDIR='EB' ;east bound
     IF (ABS(A.X-B.X)>ABS(A.Y-B.Y)&A.X>B.X) ROADDIR='WB' ; west bound
     IF (ABS(A.X-B.X)<ABS(A.Y-B.Y)&A.Y<B.Y) ROADDIR='NB' ; north bound
     IF (ABS(A.X-B.X)<ABS(A.Y-B.Y)&A.Y>B.Y) ROADDIR='SB' ; south bound

   ENDIF


; Clear several future year attributes of Baker & Putnam Counties

IF(COUNTY=5-6)
  SCREENLINE=99

  FTYPE_00A=0
  ATYPE_00A=0
  LANES_00A=0
  IMPROV_00A=''
  AGENCY_00A=''
  DESC_00A=''

  FTYPE_15A=FTYPE_05A
  ATYPE_15A=ATYPE_05A
  LANES_15A=LANES_05A
  IMPROV_15A='N'
  AGENCY_15A=''
  DESC_15A=''

  FTYPE_25A=FTYPE_05A
  ATYPE_25A=ATYPE_05A
  LANES_25A=LANES_05A
  IMPROV_25A='N'
  AGENCY_25A=''
  DESC_25A=''

  PSCF=''
  CNT_SRCE=''
  STATION_ID=''

  FTYPE_10A=FTYPE_05A
  ATYPE_10A=ATYPE_05A
  LANES_10A=LANES_05A
  IMPROV_10A='N'
  AGENCY_10A=''
  DESC_10A=''

  FTYPE_30N=FTYPE_05A
  ATYPE_30N=ATYPE_05A
  LANES_30N=LANES_05A
  IMPROV_30N='N'
  AGENCY_30N=''
  DESC_30N=''
  PROJ_30N=0

  FTYPE_30A=FTYPE_05A
  ATYPE_30A=ATYPE_05A
  LANES_30A=LANES_05A
  IMPROV_30A='N'
  AGENCY_30A=''
  DESC_30A=''

  IMPROV_05A='N'

  AGENCY_05A=''
  DESC_05A=''
  CONSTR_00A=0

  LEVEL=0
  TMODE=0
  TTIME=0
  EECODE=0
  TOLLID=0
  CARTOLL=0
  IDLINK=''
  COUNT=0
  TCARD=0
  TC=0
  TV=0
  VC=0

  PNRTERMTIME=0
  KNRTERMTIME=0
  TBSDIST=0
  TBSTIME=0
  TFGDIST=0
  TFGTIME=0
  TFGMODE=0
  TFGNAME=''
ENDIF

; Calculate CENNEW to 1 for Baker and Putnam Centroid connectors
IF((COUNTY=5-6)&(FTYPE_05A=50))
  CENNEW=1
ENDIF

ENDPHASE

ENDRUN
